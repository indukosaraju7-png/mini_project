import{a as d}from"./stimulus-helpers-Bg5ApOVk-1.js";import{ezClearFormErrors as p}from"./error-helpers-Ddtgi0dg-1.js";import f from"./ez-base-controller-DuL8VR07-1.js";import{a as g}from"./button-helpers-CvZG-X-W-1.js";import{t as u}from"./helpers-DWGVlOV6-1.js";import"./stimulus-Cq41p_up-1.js";import"./tracking-ChOFcS2D-1.js";import"./js-Cz0CWeBA-1.js";import"./actions-C6z5I147-1.js";import"./init-user-CLXATX98-1.js";const n=class n extends f{connect(){this.openOnConnectValue&&this.open(null,this.element.id)}open(o=null,t=null){var s,i;o==null||o.preventDefault();const e=t||((s=o==null?void 0:o.params)==null?void 0:s.id)||((i=o==null?void 0:o.detail)==null?void 0:i.id);if(!e)return;const r=window.openDialog(e,o);this.closeAllOpenDialogs(),r.addEventListener("dialog:close",l=>{this.close(l)}),requestAnimationFrame(()=>{r.show(),u("dialog:open"),u("dialog:open",{},r),requestAnimationFrame(()=>{var l;(l=o==null?void 0:o.target.closest(".is-loading"))==null||l.classList.remove("is-loading")})})}close(o,t=e=>{}){var c,m;const e=o.currentTarget.closest(".dialog-modal"),r=e.querySelector('[data-dialog-modal-target="content"]'),s=e.querySelector(".ez-modal__modal");if(e.hasAttribute("data-disable-easy-close")||o.target===s)return;const i=(c=o.target)==null?void 0:c.getAttribute("data-action"),l=i&&i.match(/#close(\s|$)/);(!r.contains(o.target)||r.contains(o.target)&&l||((m=o==null?void 0:o.detail)==null?void 0:m.closeSelf)===!0)&&requestAnimationFrame(()=>{this.reloadOnCloseValue?window.location.reload():(e.close(),this.postClosingActions(e),t&&t(o))})}closeAllOpenDialogs(){[...document.querySelectorAll("dialog[open]"),...document.querySelectorAll(".ez-faux-modal")].forEach(t=>{requestAnimationFrame(()=>{t.classList.contains("dialog-modal")&&t.close(),this.postClosingActions(t)})})}postClosingActions(o){o.removeEventListener("dialog:close",t=>{this.close(t)}),this.resetDialogForm(o),this.removeIfOneShot(o)}resetDialogForm(o){const t=o.querySelector(".ez-btn.has-spinner");t&&g(t);const e=o.querySelector("form");e&&(e.reset(),this.resetFormOnDialogCloseValue&&(p(e),e.querySelectorAll('.ez-input input[required="required"], .ez-input select[required="required"]').forEach(i=>{i&&i.classList.remove("is-touched")})));const r=o.querySelectorAll(".ez-input__error-message");r&&r.forEach(s=>{s.parentNode.removeChild(s)})}removeIfOneShot(o){this.openOnConnectValue&&o.parentNode.removeChild(o)}};n.values={openOnConnect:{type:Boolean,default:!1},resetFormOnDialogClose:{type:Boolean,default:!0},reloadOnClose:Boolean};let a=n;d({name:"dialog-modal",import:a});export{a as default};
