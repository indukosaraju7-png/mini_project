import{a as m}from"./stimulus-helpers-Bg5ApOVk-1.js";import{C as d}from"./stimulus-Cq41p_up-1.js";import{sendTrackingEvent as t}from"./tracking-ChOFcS2D-1.js";import{at as c,au as p}from"./actions-C6z5I147-1.js";import{a as i}from"./js-Cz0CWeBA-1.js";import"./helpers-DWGVlOV6-1.js";import"./init-user-CLXATX98-1.js";const n=class n extends d{constructor(){super(...arguments),this.dismissTimer=null,this.checkDisplayAfterNavigation=()=>{const e=`display_after_nav_${this.element.id}`,s=sessionStorage.getItem(e);if(!s)sessionStorage.setItem(e,"1");else{const a=parseInt(s,10),r=parseInt(this.element.dataset.displayAfterNavigation,10);a>=r&&this.element.classList.remove("is-hidden"),sessionStorage.setItem(e,String(a+1))}},this.setAutoDismiss=()=>{this.dismissTimer=setTimeout(()=>{this.hide()},parseInt(this.element.dataset.dismissTimer,10))},this.close=()=>{this.element.dataset.dismissSessionId?this.setSessionCookie():this.element.classList.contains("bundles-promo")?this.setBundlePopupCookie():this.element.classList.contains("survey-promo")?this.setSurveyCookie():i.set("dismissed_promo_popup","1",{expires:null}),this.remove(),this.element.classList.add("is-hidden")},this.hide=()=>{this.element.classList.add("fade-out"),this.remove()},this.remove=()=>{this.dismissTimer&&clearTimeout(this.dismissTimer),setTimeout(()=>{this.element.remove()},500)}}connect(){this.setupSessionPopup(),this.element.dataset.dismissTimer&&this.setAutoDismiss(),this.trackPopupTrigger(),this.element.dataset.displayAfterNavigation&&this.checkDisplayAfterNavigation()}trackPopupTrigger(){this.hasTrackTriggerActionValue&&(t({element:this.element,data:{action:this.trackTriggerActionValue,label:this.getResourceType(),non_interaction:!0}}),window.addEventListener("hidePromoPopup",this.hide))}getResourceType(){const e=document.querySelector("[data-resource-type]");if(!e)return"Other";const{resourceType:s}=e.dataset;return s[0].toUpperCase()+s.substring(1).toLowerCase()}disconnect(){window.removeEventListener("hidePromoPopup",this.hide),document.removeEventListener("turbo:load",this.checkDisplayAfterNavigation)}setupSessionPopup(){const e=this.element.dataset.dismissSessionId;e&&sessionStorage.getItem(e)!=="1"&&this.element.classList.remove("is-hidden")}setSessionCookie(){const e=this.element.dataset.dismissSessionId;sessionStorage.setItem(e,"1")}setBundlePopupCookie(){const e=new Date(0);e.setUTCSeconds(parseInt(this.element.dataset.cookieExpiration,10)),i.set("dismissed_bundles_popup","1",{domain:this.cookieDomain,expires:e})}sendBundleClick(e){t({element:e.target,data:{action:c}})}sendSurveyClick(e){t({element:e.target,data:{action:p}})}setSurveyCookie(){const e=new Date(0);e.setUTCSeconds(parseInt(this.element.dataset.cookieExpiration,10)),i.set("dismissed_survey_popup","1",{domain:this.cookieDomain,expires:e})}get cookieDomain(){const e=window.location.hostname.split(".");return`${e[1]}.${e[2]}`}};n.values={trackTriggerAction:String};let o=n;m({name:"promo-popup-js",import:o});export{o as default};
