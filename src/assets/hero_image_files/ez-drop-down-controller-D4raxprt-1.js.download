import{a}from"./stimulus-helpers-Bg5ApOVk-1.js";import m from"./ez-base-controller-DuL8VR07-1.js";import{e as d}from"./events-BkNvg-Hc-1.js";import{t as p}from"./helpers-DWGVlOV6-1.js";import"./stimulus-Cq41p_up-1.js";import"./js-Cz0CWeBA-1.js";import"./init-user-CLXATX98-1.js";const c=class c extends m{constructor(){super(...arguments),this.blurSubMenu=e=>{this.element.contains(e.target)||this.closeDropDown()},this.openDropDown=()=>{window.addEventListener("keyup",this.allowEscClose),window.addEventListener("click",this.blurSubMenu),this.addLinksBlurListeners(),document.addEventListener("keydown",this.navigateSelect),requestAnimationFrame(()=>{this.element.classList.remove("is-closed"),this.element.classList.add("is-open")})},this.navigateSelect=e=>{var n,u;if(!this.element.classList.contains("is-open"))return;if(!this.focusedOption){this.setFocusedOption(this.element.querySelector(".ez-drop-down__submenu-item:first-of-type a:not(.ez-btn)"));return}const s=(n=this.focusedOption)==null?void 0:n.closest(".ez-drop-down__submenu-item"),i=(u=this.focusedOption)==null?void 0:u.closest(".ez-drop-down__submenu-group");if(e.key==="ArrowDown"){e.stopPropagation(),e.preventDefault();const t=s.nextElementSibling,o=i.nextElementSibling,r=(t==null?void 0:t.querySelector("a:not(.ez-btn)"))||(o==null?void 0:o.querySelector("a:not(.ez-btn)"));this.setFocusedOption(r)}else if(e.key==="ArrowUp"){e.stopPropagation(),e.preventDefault();const t=s.previousElementSibling,o=i.previousElementSibling,r=(t==null?void 0:t.querySelector("a:not(.ez-btn)"))||(o==null?void 0:o.querySelector(".ez-drop-down__submenu-item:last-of-type a:not(.ez-btn)"));this.setFocusedOption(r)}else e.key==="Enter"&&(this.focusedOption.click(),this.closeDropDown())},this.closeDropDown=()=>{window.removeEventListener("keyup",this.allowEscClose),window.removeEventListener("click",this.blurSubMenu),this.removeLinksBlurListeners(),requestAnimationFrame(()=>{this.element.classList.add("is-closed"),this.element.classList.remove("is-open")})},this.allowEscClose=e=>{e.keyCode===27&&this.closeDropDown()}}connect(){this.element.addEventListener(d.util.ez_drop_down.close_drop_down,this.closeDropDown)}disconnect(){this.element.removeEventListener(d.util.ez_drop_down.close_drop_down,this.closeDropDown)}handleSubMenuClick(){this.element.classList.contains("is-open")?this.closeDropDown():this.openDropDown()}closeExploreMenuItems(){p("CloseSearchExploreSubMenus")}setFocusedOption(e){if(!(e&&e instanceof HTMLElement))return;requestAnimationFrame(()=>{var n;(n=this.focusedOption)==null||n.classList.remove("is-focused"),this.focusedOption=e,e.classList.add("is-focused")});const{scrollX:s,scrollY:i}=window;e.scrollIntoView({container:"nearest",block:"end"}),window.scrollTo(s,i)}addLinksBlurListeners(){const e=this.element.querySelectorAll(".ez-drop-down__submenu-item a");e==null||e.forEach(s=>{this.closeSubMenuOnClick()&&s.addEventListener("click",this.closeDropDown)})}removeLinksBlurListeners(){const e=this.element.querySelectorAll(".ez-drop-down__submenu-item a");e==null||e.forEach(s=>{s.removeEventListener("click",this.closeDropDown)})}closeSubMenuOnClick(){return this.hasCloseOnLinkClickValue?this.closeOnLinkClickValue:!0}};c.values={closeOnLinkClick:Boolean,selected:String};let l=c;a({name:"ez-drop-down",import:l});export{l as default};
